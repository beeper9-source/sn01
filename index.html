<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÏàòÎÇ¥Ï≤¥ÏûÑÎ≤ÑÏïôÏÉÅÎ∏î Ï∂úÏÑùÎ∂Ä v0.1 </title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="logo.png" type="image/png">
    <!-- PWA manifestÎäî Î°úÏª¨ ÌååÏùº ÏãúÏä§ÌÖúÏóêÏÑú CORS Ïò§Î•òÎ•º Î∞úÏÉùÏãúÌÇ¨ Ïàò ÏûàÏúºÎØÄÎ°ú Ï£ºÏÑù Ï≤òÎ¶¨ -->
    <!-- <link rel="manifest" href="manifest.json"> -->
    <meta name="theme-color" content="#4facfe">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Ï∂úÏÑùÎ∂Ä">
    
    <!-- Supabase ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script src="supabase-config.js"></script>
</head>
<body>
    <div class="container">
        <header class="header">
            <img src="logo.png" alt="ÏàòÎÇ¥Ï≤¥ÏûÑÎ≤ÑÏïôÏÉÅÎ∏î Î°úÍ≥†" class="logo" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
            <div class="logo-fallback" style="display: none;">üéº</div>
            <h1>ÏàòÎÇ¥Ï≤¥ÏûÑÎ≤ÑÏïôÏÉÅÎ∏î Ï∂úÏÑùÎ∂Ä v0.2</h1>
            <div class="header-actions">
                <button id="memberManageBtn" class="member-manage-btn">Îã®Ïõê Í¥ÄÎ¶¨</button>
                <button id="sheetMusicManageBtn" class="sheet-music-manage-btn">ÏïÖÎ≥¥ Í¥ÄÎ¶¨</button>
                <button id="practiceSongManageBtn" class="practice-song-manage-btn">Ïó∞ÏäµÍ≥° Í¥ÄÎ¶¨</button>
                <div class="sync-time" id="syncTime">
                    <span class="sync-time-value" id="syncTimeValue">-</span>
                </div>
            </div>
        </header>

        <div class="class-info">
            <h2>25ÎÖÑ Í∞ÄÏùÑÌïôÍ∏∞</h2>
            <p>Îß§Ï£º ÏùºÏöîÏùº | Ï¥ù 11ÌöåÏ∞®</p>
        </div>

        <div class="session-selector">
            <label for="sessionSelect">ÌöåÏ∞® ÏÑ†ÌÉù:</label>
            <select id="sessionSelect">
                <option value="1">1ÌöåÏ∞® (9/7)</option>
                <option value="2">2ÌöåÏ∞® (9/14)</option>
                <option value="3">3ÌöåÏ∞® (9/21)</option>
                <option value="4">4ÌöåÏ∞® (9/28)</option>
                <option value="5">Ìú¥Í∞ï (10/5)</option>
                <option value="6">5ÌöåÏ∞® (10/12)</option>
                <option value="7">6ÌöåÏ∞® (10/19)</option>
                <option value="8">7ÌöåÏ∞® (10/26)</option>
                <option value="9">8ÌöåÏ∞® (11/2)</option>
                <option value="10">9ÌöåÏ∞® (11/9)</option>
                <option value="11">10ÌöåÏ∞® (11/16)</option>
                <option value="12">11ÌöåÏ∞® (11/30) - Ï¢ÖÍ∞ï</option>
            </select>
        </div>


        <div class="attendance-summary">
            <div class="summary-item">
                <span class="summary-label">Ï∂úÏÑù:</span>
                <span class="summary-count" id="attendanceCount">0</span>
            </div>
            <div class="summary-item">
                <span class="summary-label">Í≤∞ÏÑù:</span>
                <span class="summary-count" id="absenceCount">0</span>
            </div>
            <div class="summary-item">
                <span class="summary-label">ÎØ∏Ï†ï:</span>
                <span class="summary-count" id="pendingCount">0</span>
            </div>
            <div class="summary-item" id="holidaySummary" style="display: none;">
                <span class="summary-label">Ìú¥Í∞ï:</span>
                <span class="summary-count" id="holidayCount">0</span>
            </div>
        </div>

        <div class="instrument-summary">
            <h3>ÏïÖÍ∏∞Î≥Ñ Ï∂úÏÑù ÌòÑÌô©</h3>
            <div class="instrument-grid">
                <div class="instrument-card" data-instrument="Î∞îÏù¥Ïò¨Î¶∞">
                    <div class="instrument-header">
                        <h4>Î∞îÏù¥Ïò¨Î¶∞</h4>
                        <div class="header-right">
                            <span class="member-count" id="violin-count">-Î™Ö</span>
                            <span class="attendance-rate" id="violin-rate"></span>
                        </div>
                    </div>
                    <div class="instrument-stats">
                        <div class="stat-item">
                            <span class="stat-label">Ï∂úÏÑù</span>
                            <span class="stat-count present" id="violin-present">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Í≤∞ÏÑù</span>
                            <span class="stat-count absent" id="violin-absent">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">ÎØ∏Ï†ï</span>
                            <span class="stat-count pending" id="violin-pending">4</span>
                        </div>
                        <div class="stat-item" id="violin-holiday-item" style="display: none;">
                            <span class="stat-label">Ìú¥Í∞ï</span>
                            <span class="stat-count holiday" id="violin-holiday">0</span>
                        </div>
                    </div>
                </div>

                <div class="instrument-card" data-instrument="Ï≤ºÎ°ú">
                    <div class="instrument-header">
                        <h4>Ï≤ºÎ°ú</h4>
                        <div class="header-right">
                            <span class="member-count" id="cello-count">-Î™Ö</span>
                            <span class="attendance-rate" id="cello-rate"></span>
                        </div>
                    </div>
                    <div class="instrument-stats">
                        <div class="stat-item">
                            <span class="stat-label">Ï∂úÏÑù</span>
                            <span class="stat-count present" id="cello-present">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Í≤∞ÏÑù</span>
                            <span class="stat-count absent" id="cello-absent">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">ÎØ∏Ï†ï</span>
                            <span class="stat-count pending" id="cello-pending">5</span>
                        </div>
                        <div class="stat-item" id="cello-holiday-item" style="display: none;">
                            <span class="stat-label">Ìú¥Í∞ï</span>
                            <span class="stat-count holiday" id="cello-holiday">0</span>
                        </div>
                    </div>
                </div>

                <div class="instrument-card" data-instrument="ÌîåÎ£ª">
                    <div class="instrument-header">
                        <h4>ÌîåÎ£ª</h4>
                        <div class="header-right">
                            <span class="member-count" id="flute-count">-Î™Ö</span>
                            <span class="attendance-rate" id="flute-rate"></span>
                        </div>
                    </div>
                    <div class="instrument-stats">
                        <div class="stat-item">
                            <span class="stat-label">Ï∂úÏÑù</span>
                            <span class="stat-count present" id="flute-present">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Í≤∞ÏÑù</span>
                            <span class="stat-count absent" id="flute-absent">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">ÎØ∏Ï†ï</span>
                            <span class="stat-count pending" id="flute-pending">3</span>
                        </div>
                        <div class="stat-item" id="flute-holiday-item" style="display: none;">
                            <span class="stat-label">Ìú¥Í∞ï</span>
                            <span class="stat-count holiday" id="flute-holiday">0</span>
                        </div>
                    </div>
                </div>

                <div class="instrument-card" data-instrument="ÌÅ¥ÎùºÎ¶¨ÎÑ∑">
                    <div class="instrument-header">
                        <h4>ÌÅ¥ÎùºÎ¶¨ÎÑ∑</h4>
                        <div class="header-right">
                            <span class="member-count" id="clarinet-count">-Î™Ö</span>
                            <span class="attendance-rate" id="clarinet-rate"></span>
                        </div>
                    </div>
                    <div class="instrument-stats">
                        <div class="stat-item">
                            <span class="stat-label">Ï∂úÏÑù</span>
                            <span class="stat-count present" id="clarinet-present">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Í≤∞ÏÑù</span>
                            <span class="stat-count absent" id="clarinet-absent">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">ÎØ∏Ï†ï</span>
                            <span class="stat-count pending" id="clarinet-pending">5</span>
                        </div>
                        <div class="stat-item" id="clarinet-holiday-item" style="display: none;">
                            <span class="stat-label">Ìú¥Í∞ï</span>
                            <span class="stat-count holiday" id="clarinet-holiday">0</span>
                        </div>
                    </div>
                </div>

                <div class="instrument-card" data-instrument="ÌîºÏïÑÎÖ∏">
                    <div class="instrument-header">
                        <h4>ÌîºÏïÑÎÖ∏</h4>
                        <div class="header-right">
                            <span class="member-count" id="piano-count">-Î™Ö</span>
                            <span class="attendance-rate" id="piano-rate"></span>
                        </div>
                    </div>
                    <div class="instrument-stats">
                        <div class="stat-item">
                            <span class="stat-label">Ï∂úÏÑù</span>
                            <span class="stat-count present" id="piano-present">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">Í≤∞ÏÑù</span>
                            <span class="stat-count absent" id="piano-absent">0</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-label">ÎØ∏Ï†ï</span>
                            <span class="stat-count pending" id="piano-pending">1</span>
                        </div>
                        <div class="stat-item" id="piano-holiday-item" style="display: none;">
                            <span class="stat-label">Ìú¥Í∞ï</span>
                            <span class="stat-count holiday" id="piano-holiday">0</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="member-list" id="memberList">
            <!-- Î©§Î≤Ñ Î™©Î°ùÏù¥ Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú ÏÉùÏÑ±Îê©ÎãàÎã§ -->
        </div>

        <div class="sync-status-section">
            <div class="sync-status" id="syncStatus">
                <span class="sync-indicator" id="syncIndicator">‚óè</span>
                <span class="sync-text" id="syncText">ÎèôÍ∏∞Ìôî Ï§ÄÎπÑÎê®</span>
            </div>
        </div>
    </div>

    <!-- ÌöåÏõê Í¥ÄÎ¶¨ Î™®Îã¨ -->
    <div id="memberManageModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ÌöåÏõê Í¥ÄÎ¶¨</h2>
                <button id="closeModal" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="member-list-header">
                    <button id="addMemberBtn" class="add-member-btn">+ ÌöåÏõê Ï∂îÍ∞Ä</button>
                </div>
                <div id="memberManageList" class="member-manage-list">
                    <!-- ÌöåÏõê Î™©Î°ùÏù¥ Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú ÏÉùÏÑ±Îê©ÎãàÎã§ -->
                </div>
            </div>
        </div>
    </div>

    <!-- ÌöåÏõê Ï∂îÍ∞Ä/ÏàòÏ†ï Î™®Îã¨ -->
    <div id="memberFormModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="memberFormTitle">ÌöåÏõê Ï∂îÍ∞Ä</h2>
                <button id="closeFormModal" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <form id="memberForm" class="member-form">
                    <div class="form-group">
                        <label for="memberName">Ïù¥Î¶Ñ:</label>
                        <input type="text" id="memberName" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="memberInstrument">ÏïÖÍ∏∞:</label>
                        <select id="memberInstrument" name="instrument" required>
                            <option value="">ÏïÖÍ∏∞Î•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</option>
                            <option value="Î∞îÏù¥Ïò¨Î¶∞">Î∞îÏù¥Ïò¨Î¶∞</option>
                            <option value="Ï≤ºÎ°ú">Ï≤ºÎ°ú</option>
                            <option value="ÌîåÎ£ª">ÌîåÎ£ª</option>
                            <option value="ÌÅ¥ÎùºÎ¶¨ÎÑ∑">ÌÅ¥ÎùºÎ¶¨ÎÑ∑</option>
                            <option value="ÌîºÏïÑÎÖ∏">ÌîºÏïÑÎÖ∏</option>
                        </select>
                    </div>
                    <div class="form-actions">
                        <button type="button" id="cancelMemberBtn" class="cancel-btn">Ï∑®ÏÜå</button>
                        <button type="submit" id="saveMemberBtn" class="save-btn">Ï†ÄÏû•</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- ÏïÖÎ≥¥ Í¥ÄÎ¶¨ Î™®Îã¨ -->
    <div id="sheetMusicManageModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ÏïÖÎ≥¥ Í¥ÄÎ¶¨</h2>
                <button id="closeSheetMusicModal" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="sheet-music-list-header">
                    <button id="addSheetMusicBtn" class="add-sheet-music-btn">+ ÏïÖÎ≥¥ Ï∂îÍ∞Ä</button>
                    <div class="search-box">
                        <input type="text" id="sheetMusicSearch" placeholder="ÏïÖÎ≥¥ Í≤ÄÏÉâ...">
                    </div>
                </div>
                <div id="sheetMusicList" class="sheet-music-list">
                    <!-- ÏïÖÎ≥¥ Î™©Î°ùÏù¥ Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú Ï∂îÍ∞ÄÎê©ÎãàÎã§ -->
                </div>
                <div id="fileModal" class="modal">
                    <div class="modal-content file-modal-content">
                        <div class="modal-header">
                            <h2 id="fileModalTitle">Ï≤®Î∂ÄÌååÏùº</h2>
                            <button id="closeFileModal" class="close-btn">&times;</button>
                        </div>
                        <div class="modal-body">
                            <div id="fileList" class="file-list">
                                <!-- Ï≤®Î∂ÄÌååÏùº Î™©Î°ùÏù¥ Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- ÏïÖÎ≥¥ ÏÉÅÏÑ∏Î≥¥Í∏∞ Î™®Îã¨ -->
                <div id="sheetDetailModal" class="modal">
                    <div class="modal-content sheet-detail-modal-content">
                        <div class="modal-header">
                            <h2 id="sheetDetailTitle">ÏïÖÎ≥¥ ÏÉÅÏÑ∏Ï†ïÎ≥¥</h2>
                            <button id="closeSheetDetailModal" class="close-btn">&times;</button>
                        </div>
                        <div class="modal-body">
                            <div id="sheetDetailContent" class="sheet-detail-content">
                                <!-- ÏïÖÎ≥¥ ÏÉÅÏÑ∏ Ï†ïÎ≥¥Í∞Ä Ïó¨Í∏∞Ïóê ÌëúÏãúÎê©ÎãàÎã§ -->
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- ÎπÑÎ∞ÄÎ≤àÌò∏ ÏûÖÎ†• Î™®Îã¨ -->
    <div id="passwordModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>ÏïÖÎ≥¥ Í¥ÄÎ¶¨ Ï†ëÍ∑º</h2>
                <button id="closePasswordModal" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="passwordInput">ÎπÑÎ∞ÄÎ≤àÌò∏Î•º ÏûÖÎ†•ÌïòÏÑ∏Ïöî:</label>
                    <input type="password" id="passwordInput" placeholder="ÎπÑÎ∞ÄÎ≤àÌò∏ ÏûÖÎ†•" autocomplete="off">
                </div>
                <div class="modal-actions">
                    <button type="button" id="confirmPasswordBtn" class="save-btn">ÌôïÏù∏</button>
                    <button type="button" id="cancelPasswordBtn" class="cancel-btn">Ï∑®ÏÜå</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Ïó∞ÏäµÍ≥° Í¥ÄÎ¶¨ Î™®Îã¨ -->
    <div id="practiceSongManageModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Ïó∞ÏäµÍ≥° Í¥ÄÎ¶¨</h2>
                <button id="closePracticeSongModal" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="practice-song-list-header">
                    <button id="addPracticeSongBtn" class="add-practice-song-btn">+ Ïó∞ÏäµÍ≥° Ï∂îÍ∞Ä</button>
                    <div class="search-box">
                        <input type="text" id="practiceSongSearchInput" placeholder="Ïó∞ÏäµÍ≥° Í≤ÄÏÉâ...">
                    </div>
                </div>
                <div id="practiceSongManageList" class="practice-song-manage-list">
                    <!-- Ïó∞ÏäµÍ≥° Î™©Î°ùÏù¥ Ïó¨Í∏∞Ïóê ÎèôÏ†ÅÏúºÎ°ú ÏÉùÏÑ±Îê©ÎãàÎã§ -->
                </div>
            </div>
        </div>
    </div>

    <!-- Ïó∞ÏäµÍ≥° Ï∂îÍ∞Ä/ÏàòÏ†ï Î™®Îã¨ -->
    <div id="practiceSongFormModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="practiceSongFormTitle">Ïó∞ÏäµÍ≥° Ï∂îÍ∞Ä</h2>
                <button id="closePracticeSongFormModal" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <form id="practiceSongForm" class="practice-song-form">
                    <div class="form-group">
                        <label for="practiceSongTitle">Í≥°Î™Ö *</label>
                        <input type="text" id="practiceSongTitle" name="title" required>
                    </div>
                    <div class="form-group">
                        <label for="practiceSongComposer">ÏûëÍ≥°Í∞Ä</label>
                        <input type="text" id="practiceSongComposer" name="composer">
                    </div>
                    <div class="form-group">
                        <label for="practiceSongDescription">ÏÑ§Î™Ö</label>
                        <textarea id="practiceSongDescription" name="description" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="practiceSongDifficulty">ÎÇúÏù¥ÎèÑ</label>
                        <select id="practiceSongDifficulty" name="difficulty">
                            <option value="Ïâ¨ÏõÄ">Ïâ¨ÏõÄ</option>
                            <option value="Î≥¥ÌÜµ">Î≥¥ÌÜµ</option>
                            <option value="Ïñ¥Î†§ÏõÄ">Ïñ¥Î†§ÏõÄ</option>
                        </select>
                    </div>
                    <div class="form-actions">
                        <button type="button" id="cancelPracticeSongBtn" class="cancel-btn">Ï∑®ÏÜå</button>
                        <button type="submit" class="save-btn">Ï†ÄÏû•</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Ï∞®ÏàòÎ≥Ñ Ïó∞ÏäµÍ≥° ÏÑ§Ï†ï Î™®Îã¨ -->
    <div id="sessionPracticeSongModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Ï∞®ÏàòÎ≥Ñ Ïó∞ÏäµÍ≥° ÏÑ§Ï†ï</h2>
                <button id="closeSessionPracticeSongModal" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="session-practice-song-content">
                    <div class="session-selector">
                        <label for="sessionPracticeSongSelect">ÌöåÏ∞® ÏÑ†ÌÉù:</label>
                        <select id="sessionPracticeSongSelect">
                            <option value="1">1ÌöåÏ∞®</option>
                            <option value="2">2ÌöåÏ∞®</option>
                            <option value="3">3ÌöåÏ∞®</option>
                            <option value="4">4ÌöåÏ∞®</option>
                            <option value="5">Ìú¥Í∞ï</option>
                            <option value="6">Ìú¥Í∞ï</option>
                            <option value="7">5ÌöåÏ∞®</option>
                            <option value="8">6ÌöåÏ∞®</option>
                            <option value="9">7ÌöåÏ∞®</option>
                            <option value="10">8ÌöåÏ∞®</option>
                            <option value="11">9ÌöåÏ∞®</option>
                            <option value="12">10ÌöåÏ∞®</option>
                            <option value="13">11ÌöåÏ∞®</option>
                        </select>
                    </div>
                    <div class="practice-song-assignment">
                        <h3>Ïó∞ÏäµÍ≥° Ìï†Îãπ</h3>
                        <div id="availablePracticeSongs" class="available-songs">
                            <!-- ÏÇ¨Ïö© Í∞ÄÎä•Ìïú Ïó∞ÏäµÍ≥° Î™©Î°ù -->
                        </div>
                        <div class="assigned-songs">
                            <h4>Ìï†ÎãπÎêú Ïó∞ÏäµÍ≥°</h4>
                            <div id="assignedPracticeSongs" class="assigned-songs-list">
                                <!-- Ìï†ÎãπÎêú Ïó∞ÏäµÍ≥° Î™©Î°ù -->
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" id="saveSessionPracticeSongBtn" class="save-btn">Ï†ÄÏû•</button>
                </div>
            </div>
        </div>
    </div>

    <!-- ÏïÖÎ≥¥ Ï∂îÍ∞Ä/ÏàòÏ†ï Î™®Îã¨ -->
    <div id="sheetMusicFormModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="sheetMusicFormTitle">ÏïÖÎ≥¥ Ï∂îÍ∞Ä</h2>
                <button id="closeSheetMusicFormModal" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <form id="sheetMusicForm" class="sheet-music-form">
                    <div class="form-group">
                        <label for="sheetMusicTitle">Ï†úÎ™©:</label>
                        <input type="text" id="sheetMusicTitle" name="title" required>
                    </div>
                    <div class="form-group">
                        <label for="sheetMusicComposer">ÏûëÍ≥°Í∞Ä:</label>
                        <input type="text" id="sheetMusicComposer" name="composer">
                    </div>
                    <div class="form-group">
                        <label for="sheetMusicArranger">Ìé∏Í≥°Í∞Ä:</label>
                        <input type="text" id="sheetMusicArranger" name="arranger">
                    </div>
                    <div class="form-group">
                        <label for="sheetMusicGenre">Ïû•Î•¥:</label>
                        <select id="sheetMusicGenre" name="genre">
                            <option value="">Ïû•Î•¥Î•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</option>
                            <option value="ÌÅ¥ÎûòÏãù">ÌÅ¥ÎûòÏãù</option>
                            <option value="Ìåù">Ìåù</option>
                            <option value="Ïû¨Ï¶à">Ïû¨Ï¶à</option>
                            <option value="ÏòÅÌôîÏùåÏïÖ">ÏòÅÌôîÏùåÏïÖ</option>
                            <option value="ÎÆ§ÏßÄÏª¨">ÎÆ§ÏßÄÏª¨</option>
                            <option value="Í∏∞ÌÉÄ">Í∏∞ÌÉÄ</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="sheetMusicDifficulty">ÎÇúÏù¥ÎèÑ:</label>
                        <select id="sheetMusicDifficulty" name="difficulty">
                            <option value="">ÎÇúÏù¥ÎèÑÎ•º ÏÑ†ÌÉùÌïòÏÑ∏Ïöî</option>
                            <option value="Ï¥àÍ∏â">Ï¥àÍ∏â</option>
                            <option value="Ï§ëÍ∏â">Ï§ëÍ∏â</option>
                            <option value="Í≥†Í∏â">Í≥†Í∏â</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="sheetMusicNotes">Î©îÎ™®:</label>
                        <textarea id="sheetMusicNotes" name="notes" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="sheetMusicFiles">Ï≤®Î∂ÄÌååÏùº:</label>
                        <input type="file" id="sheetMusicFiles" name="files" multiple accept=".pdf,.jpg,.jpeg,.png,.gif,.mp3,.wav,.mid,.midi">
                        <div class="file-upload-info">
                            <small>ÏßÄÏõê ÌòïÏãù: PDF, Ïù¥ÎØ∏ÏßÄ(JPG, PNG, GIF), Ïò§ÎîîÏò§(MP3, WAV), MIDI</small>
                        </div>
                        <div id="filePreview" class="file-preview"></div>
                    </div>
                    <div class="form-actions">
                        <button type="button" id="cancelSheetMusicBtn" class="cancel-btn">Ï∑®ÏÜå</button>
                        <button type="submit" id="saveSheetMusicBtn" class="save-btn">Ï†ÄÏû•</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- SupabaseAttendanceManager ÌÅ¥ÎûòÏä§ ÎèôÏ†Å Ï†ïÏùò -->
    <script>
        console.log('=== SupabaseAttendanceManager ÌÅ¥ÎûòÏä§ ÎèôÏ†Å Ï†ïÏùò ÏãúÏûë ===');
        
        // ÌÅ¥ÎûòÏä§Í∞Ä ÏóÜÏúºÎ©¥ Ï†ïÏùò
        if (typeof window.SupabaseAttendanceManager === 'undefined') {
            window.SupabaseAttendanceManager = class SupabaseAttendanceManager {
                constructor() {
                    console.log('SupabaseAttendanceManager ÏÉùÏÑ±Ïûê Ìò∏Ï∂ú');
                    
                    this.storageKey = 'chamber_attendance_local';
                    this.localData = this.loadLocalData();
                    this.isOnline = navigator.onLine;
                    this.lastSyncTime = 0;
                    this.syncInterval = null;
                    
                    // Supabase ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ ÌôïÏù∏
                    if (typeof window.supabaseClient === 'undefined') {
                        console.error('Supabase ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏Í∞Ä Î°úÎìúÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§.');
                        return;
                    }
                    
                    this.supabase = window.supabaseClient;
                    console.log('Supabase ÌÅ¥ÎùºÏù¥Ïñ∏Ìä∏ Ïó∞Í≤∞ ÏôÑÎ£å');
                    
                    // Ï¥àÍ∏∞ ÎèôÍ∏∞Ìôî ÏÉÅÌÉú ÏÑ§Ï†ï
                    this.updateSyncStatus('online', 'Ïò®ÎùºÏù∏ ÏÉÅÌÉú');
                    
                    this.setupCloudSync();
                    this.initializeDatabase();
                    
                    // Ï¥àÍ∏∞ Îç∞Ïù¥ÌÑ∞ Î°úÎìú
                    this.loadAllAttendanceData();
                }

                // Î°úÏª¨ Îç∞Ïù¥ÌÑ∞ Î°úÎìú
                loadLocalData() {
                    const saved = localStorage.getItem(this.storageKey);
                    if (saved) {
                        try {
                            return JSON.parse(saved);
                        } catch (e) {
                            console.error('Î°úÏª¨ Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ïã§Ìå®:', e);
                        }
                    }
                    return {};
                }

                // Î°úÏª¨ Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
                saveLocalData() {
                    try {
                        localStorage.setItem(this.storageKey, JSON.stringify(this.localData));
                    } catch (e) {
                        console.error('Î°úÏª¨ Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû• Ïã§Ìå®:', e);
                    }
                }

                // Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ Ï¥àÍ∏∞Ìôî
                async initializeDatabase() {
                    try {
                        console.log('Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ Ï¥àÍ∏∞Ìôî ÏãúÏûë');
                        
                        // Î©§Î≤Ñ Îç∞Ïù¥ÌÑ∞Í∞Ä ÏûàÎäîÏßÄ ÌôïÏù∏
                        if (typeof members === 'undefined' || !members || members.length === 0) {
                            console.error('Î©§Î≤Ñ Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏäµÎãàÎã§.');
                            return;
                        }

                        // Î©§Î≤Ñ Îç∞Ïù¥ÌÑ∞Î•º Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§Ïóê Ï†ÄÏû•
                        const { data, error } = await this.supabase
                            .from('members')
                            .select('*');

                        if (error) {
                            console.error('Î©§Î≤Ñ Îç∞Ïù¥ÌÑ∞ Ï°∞Ìöå Ïò§Î•ò:', error);
                            return;
                        }

                        // Î©§Î≤Ñ Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏúºÎ©¥ ÏÇΩÏûÖ
                        if (!data || data.length === 0) {
                            console.log('Î©§Î≤Ñ Îç∞Ïù¥ÌÑ∞ ÏÇΩÏûÖ ÏãúÏûë');
                            const { error: insertError } = await this.supabase
                                .from('members')
                                .insert(members);

                            if (insertError) {
                                console.error('Î©§Î≤Ñ Îç∞Ïù¥ÌÑ∞ ÏÇΩÏûÖ Ïò§Î•ò:', insertError);
                            } else {
                                console.log('Î©§Î≤Ñ Îç∞Ïù¥ÌÑ∞ ÏÇΩÏûÖ ÏôÑÎ£å');
                            }
                        } else {
                            console.log('Î©§Î≤Ñ Îç∞Ïù¥ÌÑ∞ Ïù¥ÎØ∏ Ï°¥Ïû¨:', data.length, 'Î™Ö');
                        }

                    } catch (error) {
                        console.error('Îç∞Ïù¥ÌÑ∞Î≤†Ïù¥Ïä§ Ï¥àÍ∏∞Ìôî Ïò§Î•ò:', error);
                    }
                }

                // ÌÅ¥ÎùºÏö∞Îìú ÎèôÍ∏∞Ìôî ÏÑ§Ï†ï
                setupCloudSync() {
                    console.log('ÌÅ¥ÎùºÏö∞Îìú ÎèôÍ∏∞Ìôî ÏÑ§Ï†ï ÏãúÏûë');
                    
                    // Ïò®ÎùºÏù∏ ÏÉÅÌÉú Î≥ÄÍ≤Ω Í∞êÏßÄ
                    window.addEventListener('online', () => {
                        this.isOnline = true;
                        this.syncToCloud();
                    });

                    window.addEventListener('offline', () => {
                        this.isOnline = false;
                    });

                    // Ï£ºÍ∏∞Ï†Å ÎèôÍ∏∞Ìôî (5Î∂ÑÎßàÎã§)
                    this.syncInterval = setInterval(() => {
                        if (this.isOnline) {
                            this.syncToCloud();
                        }
                    }, 5 * 60 * 1000);
                }

                // ÌÅ¥ÎùºÏö∞ÎìúÎ°ú ÎèôÍ∏∞Ìôî
                async syncToCloud() {
                    if (!this.isOnline) {
                        console.log('Ïò§ÌîÑÎùºÏù∏ ÏÉÅÌÉú - ÎèôÍ∏∞Ìôî Í±¥ÎÑàÎúÄ');
                        return;
                    }

                    try {
                        console.log('ÌÅ¥ÎùºÏö∞Îìú ÎèôÍ∏∞Ìôî ÏãúÏûë');
                        
                        // Ï∂úÏÑù Í∏∞Î°ù ÎèôÍ∏∞Ìôî
                        for (const [key, attendance] of Object.entries(this.localData)) {
                            if (attendance && attendance.member_id && attendance.session) {
                                        const { error } = await this.supabase
                                            .from('attendance_records')
                                            .upsert({
                                                id: attendance.member_id,
                                                session_number: attendance.session,
                                                status: attendance.status
                                            });

                                if (error) {
                                    console.error('Ï∂úÏÑù Í∏∞Î°ù ÎèôÍ∏∞Ìôî Ïò§Î•ò:', error);
                                }
                            }
                        }

                        this.lastSyncTime = Date.now();
                        console.log('ÌÅ¥ÎùºÏö∞Îìú ÎèôÍ∏∞Ìôî ÏôÑÎ£å');
                        
                        // ÎèôÍ∏∞Ìôî ÏôÑÎ£å ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
                        this.updateSyncTime();

                    } catch (error) {
                        console.error('ÌÅ¥ÎùºÏö∞Îìú ÎèôÍ∏∞Ìôî Ïò§Î•ò:', error);
                    }
                }

                // ÌÅ¥ÎùºÏö∞ÎìúÏóêÏÑú ÎèôÍ∏∞Ìôî
                async syncFromCloud() {
                    if (!this.isOnline) {
                        console.log('Ïò§ÌîÑÎùºÏù∏ ÏÉÅÌÉú - ÎèôÍ∏∞Ìôî Í±¥ÎÑàÎúÄ');
                        return;
                    }

                    try {
                        console.log('ÌÅ¥ÎùºÏö∞ÎìúÏóêÏÑú ÎèôÍ∏∞Ìôî ÏãúÏûë');
                        
                        const { data, error } = await this.supabase
                            .from('attendance_records')
                            .select('*');

                        if (error) {
                            console.error('Ï∂úÏÑù Í∏∞Î°ù Ï°∞Ìöå Ïò§Î•ò:', error);
                            return;
                        }

                        // Î°úÏª¨ Îç∞Ïù¥ÌÑ∞ÏôÄ ÎπÑÍµêÌïòÏó¨ ÏóÖÎç∞Ïù¥Ìä∏
                        if (data) {
                            let hasChanges = false;
                            
                            data.forEach(record => {
                                const key = `${record.id}_${record.session_number}`;
                                const existingData = this.localData[key];
                                
                                if (!existingData || existingData.status !== record.status) {
                                    this.localData[key] = {
                                        member_id: record.id,
                                        session: record.session_number,
                                        status: record.status
                                    };
                                    hasChanges = true;
                                }
                            });

                            if (hasChanges) {
                                this.saveLocalData();
                                this.notifyUIUpdate();
                                console.log('ÌÅ¥ÎùºÏö∞ÎìúÏóêÏÑú ÎèôÍ∏∞Ìôî ÏôÑÎ£å:', data.length, 'Í∞ú Í∏∞Î°ù');
                            } else {
                                console.log('Îç∞Ïù¥ÌÑ∞ Î≥ÄÍ≤Ω ÏóÜÏùå');
                            }
                        }

                    } catch (error) {
                        console.error('ÌÅ¥ÎùºÏö∞ÎìúÏóêÏÑú ÎèôÍ∏∞Ìôî Ïò§Î•ò:', error);
                    }
                }

                // Ï∂úÏÑù ÏÉÅÌÉú ÏÑ§Ï†ï (script.jsÏôÄ Ìò∏ÌôòÏÑ±ÏùÑ ÏúÑÌï¥ session, memberNo, status ÏàúÏÑúÎ°ú Îß§Í∞úÎ≥ÄÏàò Î∞õÏùå)
                async setAttendance(session, memberNo, status) {
                    console.log(`Ï∂úÏÑù ÏÉÅÌÉú ÏÑ§Ï†ï: ${session}, ${memberNo}, ${status}`);
                    
                    const key = `${memberNo}_${session}`;
                    this.localData[key] = {
                        member_id: memberNo,
                        session: session,
                        status: status
                    };

                    this.saveLocalData();

                    // Î≥ÄÍ≤ΩÏÇ¨Ìï≠ ÏïåÎ¶º
                    this.notifyChange(session, memberNo, status);

                    // Ïò®ÎùºÏù∏ ÏÉÅÌÉúÎ©¥ ÌÅ¥ÎùºÏö∞ÎìúÏóê ÎèôÍ∏∞Ìôî
                    if (this.isOnline) {
                        try {
                            const { error } = await this.supabase
                                .from('attendance_records')
                                .upsert({
                                    id: memberNo,
                                    session_number: session,
                                    status: status
                                });

                            if (error) {
                                console.error('Ï∂úÏÑù ÏÉÅÌÉú Ï†ÄÏû• Ïò§Î•ò:', error);
                            } else {
                                console.log('Ï∂úÏÑù ÏÉÅÌÉú Ï†ÄÏû• ÏôÑÎ£å');
                            }
                        } catch (error) {
                            console.error('Ï∂úÏÑù ÏÉÅÌÉú Ï†ÄÏû• Ïò§Î•ò:', error);
                        }
                    }

                    return this.localData[key];
                }

                // Ï∂úÏÑù ÏÉÅÌÉú Ï°∞Ìöå (script.jsÏôÄ Ìò∏ÌôòÏÑ±ÏùÑ ÏúÑÌï¥ session, memberNo ÏàúÏÑúÎ°ú Îß§Í∞úÎ≥ÄÏàò Î∞õÏùå)
                getAttendance(session, memberNo) {
                    const key = `${memberNo}_${session}`;
                    return this.localData[key] || { status: 'pending' };
                }

                // Î™®Îì† Ï∂úÏÑù Îç∞Ïù¥ÌÑ∞Î•º Ìïú Î≤àÏóê Î°úÎìú
                async loadAllAttendanceData() {
                    if (!this.isOnline) {
                        console.log('Ïò§ÌîÑÎùºÏù∏ ÏÉÅÌÉú - Îç∞Ïù¥ÌÑ∞ Î°úÎìú Í±¥ÎÑàÎúÄ');
                        return;
                    }

                    try {
                        console.log('Î™®Îì† Ï∂úÏÑù Îç∞Ïù¥ÌÑ∞ Î°úÎìú ÏãúÏûë');
                        
                        const { data, error } = await this.supabase
                            .from('attendance_records')
                            .select('*');

                        if (error) {
                            console.error('Ï∂úÏÑù Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ïò§Î•ò:', error);
                            return;
                        }

                        // Î°úÏª¨ Îç∞Ïù¥ÌÑ∞ Ï¥àÍ∏∞Ìôî
                        this.localData = {};

                        // Îç∞Ïù¥ÌÑ∞Î•º Î°úÏª¨Ïóê Ï†ÄÏû•
                        if (data) {
                            data.forEach(record => {
                                const key = `${record.id}_${record.session_number}`;
                                this.localData[key] = {
                                    member_id: record.id,
                                    session: record.session_number,
                                    status: record.status
                                };
                            });

                            this.saveLocalData();
                            console.log('Î™®Îì† Ï∂úÏÑù Îç∞Ïù¥ÌÑ∞ Î°úÎìú ÏôÑÎ£å:', data.length, 'Í∞ú Í∏∞Î°ù');
                        }

                    } catch (error) {
                        console.error('Ï∂úÏÑù Îç∞Ïù¥ÌÑ∞ Î°úÎìú Ïò§Î•ò:', error);
                    }
                }

                // Î™®Îì† Ï∂úÏÑù Îç∞Ïù¥ÌÑ∞ Ï°∞Ìöå
                getAllAttendance() {
                    return this.localData;
                }

                // ÌäπÏ†ï Î©§Î≤ÑÏùò Ï∂úÏÑù ÏÉÅÌÉú Ï°∞Ìöå (script.jsÏôÄ Ìò∏ÌôòÏÑ±ÏùÑ ÏúÑÌï¥ session, memberNo ÏàúÏÑúÎ°ú Îß§Í∞úÎ≥ÄÏàò Î∞õÏùå)
                getAttendance(session, memberNo) {
                    const key = `${memberNo}_${session}`;
                    const attendance = this.localData[key];
                    
                    if (attendance) {
                        return {
                            status: attendance.status,
                            member_id: attendance.member_id,
                            session: attendance.session
                        };
                    }
                    
                    // Îç∞Ïù¥ÌÑ∞Í∞Ä ÏóÜÏúºÎ©¥ Í∏∞Î≥∏Í∞í Î∞òÌôò
                    return {
                        status: 'pending',
                        member_id: memberNo,
                        session: session
                    };
                }

                // ÏÑ∏ÏÖòÎ≥Ñ ÏöîÏïΩ Ï†ïÎ≥¥
                getSessionSummary(session) {
                    const summary = {
                        present: 0,
                        absent: 0,
                        pending: 0,
                        holiday: 0
                    };

                    // Ìú¥Í∞ïÏùºÏù∏ Í≤ΩÏö∞
                    if (HOLIDAY_SESSIONS.includes(session)) {
                        summary.holiday = members.length;
                        return summary;
                    }

                    // Î©§Î≤ÑÎ≥Ñ Ï∂úÏÑù ÏÉÅÌÉú ÌôïÏù∏
                    members.forEach(member => {
                        const attendance = this.getAttendance(session, member.no);
                        const status = attendance.status || 'pending';
                        if (status === 'present') {
                            summary.present++;
                        } else if (status === 'absent') {
                            summary.absent++;
                        } else {
                            summary.pending++;
                        }
                    });

                    return summary;
                }

                // ÏïÖÍ∏∞Î≥Ñ ÏöîÏïΩ Ï†ïÎ≥¥
                getInstrumentSummary(session) {
                    const instrumentSummary = {};

                    // ÏïÖÍ∏∞Î≥ÑÎ°ú Ï¥àÍ∏∞Ìôî
                    const instruments = ['Î∞îÏù¥Ïò¨Î¶∞', 'Ï≤ºÎ°ú', 'ÌîåÎ£ª', 'ÌÅ¥ÎùºÎ¶¨ÎÑ∑', 'ÌîºÏïÑÎÖ∏'];
                    instruments.forEach(instrument => {
                        instrumentSummary[instrument] = {
                            present: 0,
                            absent: 0,
                            pending: 0,
                            holiday: 0,
                            total: 0,
                            attendanceRate: 0 // Ï∂úÏÑùÏú® Ï∂îÍ∞Ä
                        };
                    });

                    // Ìú¥Í∞ïÏùºÏù∏ Í≤ΩÏö∞ Î™®Îì† Î©§Î≤ÑÎ•º Ìú¥Í∞ïÏúºÎ°ú Ï≤òÎ¶¨
                    if (HOLIDAY_SESSIONS.includes(session)) {
                        members.forEach(member => {
                            instrumentSummary[member.instrument].holiday++;
                            instrumentSummary[member.instrument].total++;
                        });
                        return instrumentSummary;
                    }

                    // Í∞Å Î©§Î≤ÑÏùò Ï∂úÏÑù ÏÉÅÌÉúÎ•º ÏïÖÍ∏∞Î≥ÑÎ°ú ÏßëÍ≥Ñ
                    members.forEach(member => {
                        const attendance = this.getAttendance(session, member.no);
                        const status = attendance.status || 'pending';
                        instrumentSummary[member.instrument][status]++;
                        instrumentSummary[member.instrument].total++;
                    });

                    // Ï∂úÏÑùÏú® Í≥ÑÏÇ∞ (ÎàÑÏ†Å)
                    instruments.forEach(instrument => {
                        const summary = instrumentSummary[instrument];
                        if (summary.total > 0) {
                            // Ï∂úÏÑùÏú® = (Ï∂úÏÑù + Í≤∞ÏÑù) Ï§ëÏóêÏÑú Ï∂úÏÑùÏùò ÎπÑÏú®
                            const totalSessions = summary.present + summary.absent;
                            if (totalSessions > 0) {
                                summary.attendanceRate = Math.round((summary.present / totalSessions) * 100);
                            } else {
                                summary.attendanceRate = 0;
                            }
                        }
                    });

                    return instrumentSummary;
                }

                // ÏïÖÍ∏∞Î≥Ñ ÎàÑÏ†Å Ï∂úÏÑùÏú® Í≥ÑÏÇ∞ (Î™®Îì† ÌöåÏ∞®)
                getInstrumentCumulativeAttendanceRate() {
                    const instrumentSummary = {};

                    // ÏïÖÍ∏∞Î≥ÑÎ°ú Ï¥àÍ∏∞Ìôî
                    const instruments = ['Î∞îÏù¥Ïò¨Î¶∞', 'Ï≤ºÎ°ú', 'ÌîåÎ£ª', 'ÌÅ¥ÎùºÎ¶¨ÎÑ∑', 'ÌîºÏïÑÎÖ∏'];
                    instruments.forEach(instrument => {
                        instrumentSummary[instrument] = {
                            totalPresent: 0,
                            totalAbsent: 0,
                            totalSessions: 0,
                            attendanceRate: 0
                        };
                    });

                    // Î™®Îì† ÌöåÏ∞®Ïóê ÎåÄÌï¥ ÏßëÍ≥Ñ (Ìú¥Í∞ï Ï†úÏô∏)
                    for (let session = 1; session <= 12; session++) {
                        if (HOLIDAY_SESSIONS.includes(session)) continue; // Ìú¥Í∞ï Ï†úÏô∏

                        members.forEach(member => {
                            const attendance = this.getAttendance(session, member.no);
                            const status = attendance.status || 'pending';
                            
                            if (status === 'present') {
                                instrumentSummary[member.instrument].totalPresent++;
                                instrumentSummary[member.instrument].totalSessions++;
                            } else if (status === 'absent') {
                                instrumentSummary[member.instrument].totalAbsent++;
                                instrumentSummary[member.instrument].totalSessions++;
                            }
                        });
                    }

                    // ÎàÑÏ†Å Ï∂úÏÑùÏú® Í≥ÑÏÇ∞
                    instruments.forEach(instrument => {
                        const summary = instrumentSummary[instrument];
                        if (summary.totalSessions > 0) {
                            summary.attendanceRate = Math.round((summary.totalPresent / summary.totalSessions) * 100);
                        } else {
                            summary.attendanceRate = 0;
                        }
                    });

                    return instrumentSummary;
                }

                // Îç∞Ïù¥ÌÑ∞ Ï†ÄÏû•
                async saveData() {
                    this.saveLocalData();
                    if (this.isOnline) {
                        await this.syncToCloud();
                    }
                    return true;
                }

                // UI ÏóÖÎç∞Ïù¥Ìä∏ ÏïåÎ¶º
                notifyUIUpdate() {
                    const event = new CustomEvent('attendanceUpdated', {
                        detail: { data: this.localData }
                    });
                    window.dispatchEvent(event);
                }

                // Î≥ÄÍ≤ΩÏÇ¨Ìï≠ Í∞êÏßÄ (BroadcastChannel ÏÇ¨Ïö©)
                listenForChanges(callback) {
                    if (typeof BroadcastChannel !== 'undefined') {
                        const channel = new BroadcastChannel('attendance_channel');
                        channel.onmessage = (event) => {
                            if (event.data.type === 'attendance_change') {
                                callback(event.data);
                            }
                        };
                        return channel;
                    }
                    return null;
                }

                // Î≥ÄÍ≤ΩÏÇ¨Ìï≠ ÏïåÎ¶º
                notifyChange(session, memberNo, status) {
                    // Îã§Î•∏ ÌÉ≠Ïù¥ÎÇò Ï∞ΩÏóê Î≥ÄÍ≤ΩÏÇ¨Ìï≠ ÏïåÎ¶º
                    if (typeof BroadcastChannel !== 'undefined') {
                        const channel = new BroadcastChannel('attendance_channel');
                        channel.postMessage({
                            type: 'attendance_change',
                            session,
                            memberNo,
                            status,
                            timestamp: Date.now()
                        });
                        channel.close();
                    }
                }

                // ÏóÖÎç∞Ïù¥Ìä∏ ÌôïÏù∏
                checkForUpdates() {
                    // ÌéòÏù¥ÏßÄ Í∞ÄÏãúÏÑ± Î≥ÄÍ≤Ω Ïãú Ìò∏Ï∂úÎêòÎäî Ìï®Ïàò
                    console.log('ÏóÖÎç∞Ïù¥Ìä∏ ÌôïÏù∏ Ï§ë...');
                    this.notifyUIUpdate();
                }

                // ÎèôÍ∏∞Ìôî ÏÉÅÌÉú ÏóÖÎç∞Ïù¥Ìä∏
                updateSyncStatus(status, message) {
                    const syncText = document.getElementById('syncText');
                    if (syncText) {
                        syncText.textContent = message;
                        syncText.className = `sync-text ${status}`;
                    }
                    console.log(`ÎèôÍ∏∞Ìôî ÏÉÅÌÉú: ${status} - ${message}`);
                }

                // ÎèôÍ∏∞Ìôî ÏãúÍ∞Ñ ÏóÖÎç∞Ïù¥Ìä∏
                updateSyncTime() {
                    const now = new Date();
                    const timeString = now.toLocaleTimeString('ko-KR', { 
                        hour: '2-digit', 
                        minute: '2-digit' 
                    });
                    this.updateSyncStatus('synced', `ÎßàÏßÄÎßâ ÎèôÍ∏∞Ìôî: ${timeString}`);
                }

                // Íµ¨ÎèÖ Ï†ïÎ¶¨
                cleanup() {
                    if (this.syncInterval) {
                        clearInterval(this.syncInterval);
                    }
                    
                    if (this.supabase) {
                        this.supabase.removeAllChannels();
                    }
                }
            };
            
            console.log('SupabaseAttendanceManager ÌÅ¥ÎûòÏä§ ÎèôÏ†Å Ï†ïÏùò ÏôÑÎ£å');
        }
        
        console.log('=== SupabaseAttendanceManager ÌÅ¥ÎûòÏä§ Ï†ïÏùò ÏôÑÎ£å ===');
        console.log('SupabaseAttendanceManager ÌÅ¥ÎûòÏä§ Îì±Î°ùÎê®:', typeof window.SupabaseAttendanceManager !== 'undefined');
    </script>
    
    <!-- Ïä§ÌÅ¨Î¶ΩÌä∏ Î°úÎìú ÌôïÏù∏ -->
    <script>
        console.log('=== index.html Ïä§ÌÅ¨Î¶ΩÌä∏ Î°úÎìú ÌôïÏù∏ ===');
        console.log('SupabaseAttendanceManager ÌÅ¥ÎûòÏä§ Ï°¥Ïû¨:', typeof SupabaseAttendanceManager !== 'undefined');
        console.log('window.SupabaseAttendanceManager Ï°¥Ïû¨:', typeof window.SupabaseAttendanceManager !== 'undefined');
    </script>
    
    <script src="script.js"></script>
    
    <!-- script.js Î°úÎìú ÌõÑ ÌôïÏù∏ -->
    <script>
        console.log('script.js Î°úÎìú ÏôÑÎ£å');
        console.log('members Ï†ïÏùòÎê®:', typeof members !== 'undefined');
        if (typeof members !== 'undefined') {
            console.log('Î©§Î≤Ñ Ïàò:', members.length);
        }
    </script>
</body>
</html>
